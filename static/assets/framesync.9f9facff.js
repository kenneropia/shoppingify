var e="undefined"!=typeof performance?function(){return performance.now()}:function(){return Date.now()},n="undefined"!=typeof window?function(e){return window.requestAnimationFrame(e)}:function(n){return setTimeout((function(){return n(e())}),16.666666666666668)};var r=!0,t=!1,u=!1,o={delta:0,timestamp:0},c=["read","update","preRender","render","postRender"],i=c.reduce((function(e,n){var r,u,o,c,i,a,f;return e[n]=(r=function(){return t=!0},u=[],o=[],c=0,i=!1,a=new WeakSet,f={schedule:function(e,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1);var t=r&&i,f=t?u:o;return n&&a.add(e),-1===f.indexOf(e)&&(f.push(e),t&&i&&(c=u.length)),e},cancel:function(e){var n=o.indexOf(e);-1!==n&&o.splice(n,1),a.delete(e)},process:function(e){var n;if(i=!0,u=(n=[o,u])[0],(o=n[1]).length=0,c=u.length)for(var t=0;t<c;t++){var d=u[t];d(e),a.has(d)&&(f.schedule(d),r())}i=!1}}),e}),{}),a=c.reduce((function(e,n){var r=i[n];return e[n]=function(e,n,u){return void 0===n&&(n=!1),void 0===u&&(u=!1),t||m(),r.schedule(e,n,u)},e}),{}),f=c.reduce((function(e,n){return e[n]=i[n].cancel,e}),{}),d=c.reduce((function(e,n){return e[n]=function(){return i[n].process(o)},e}),{}),s=function(e){return i[e].process(o)},p=function(e){t=!1,o.delta=r?16.666666666666668:Math.max(Math.min(e-o.timestamp,40),1),o.timestamp=e,u=!0,c.forEach(s),u=!1,t&&(r=!1,n(p))},m=function(){t=!0,r=!0,u||n(p)},v=function(){return o};export{f as c,d as f,v as g,a as s};
